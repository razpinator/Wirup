var wirup=(function(){"use strict";const u=e=>document.getElementById(e),D=e=>{try{return JSON.parse(window[e])}catch{return window[e]}},h=e=>new Promise((n,t)=>{let r=document.createElement("script");r.type="text/javascript",r.src=e,document.getElementsByTagName("head")[0].appendChild(r),r.onload=()=>{n()},r.onerror=()=>{t(`Failed to load script: ${e}`)}}),E=(e,n)=>new Promise((t,r)=>{const o=n.map(s=>h(`${e}/${s}`));Promise.all(o).then(t).catch(s=>{console.error(`Error loading scripts from folder: ${s}`),r(s)})}).catch(t=>{console.error(`Error in loadScriptsFromFolder: ${t}`)}),y=(e,n,t,r)=>new Promise((o,s)=>{const i=new XMLHttpRequest;i.open(e,n,!0),i.setRequestHeader("Content-Type",t),i.setRequestHeader("cache-control","no-cache"),i.setRequestHeader("expires","0"),i.setRequestHeader("expires","Tue, 01 Jan 1980 1:00:00 GMT"),i.setRequestHeader("pragma","no-cache"),i.onreadystatechange=()=>{if(i.readyState===4)if(i.status===200)o(r?r(i.responseText):i.responseText);else{const d=i.statusText||"Your ajax request threw an error.";s(d)}},i.send()});let g="";const m="wuActions",L=e=>{g=e},p=(e,n,t)=>{const o=new Date().getTime(),s={name:e,element:n,comment:t,profile:g,timestamp:o},i=localStorage.getItem(m)||"",d=i?",":"";localStorage.setItem(m,i+d+JSON.stringify(s))},a={};let C=e=>{console.warn("updateComponentsCallback not registered",e)};const j=e=>{C=e},k=(e,n)=>{Object.defineProperty(a,e,{get:function(){return this["_"+e]},set:function(t){this["_"+e]=t,C(e)},configurable:!0}),a[e]=n},P=(e,n)=>{Array.isArray(a[e])||a[e];const t=a[e];t.push(n),a[e]=t},B=(e,n,t)=>{if(!a[e])throw new Error(`Data source '${e}' not found in dataStore`);return a[e].findIndex(o=>o[n]===t)},R=(e,n,t)=>{const r=a[e];let o=n-1<0?0:n-1;r[o]=t,a[e]=r},F=(e,n)=>{const t=a[e];let r=n-1<0?0:n-1;t.splice(r,1),a[e]=t},c={},q=(e,n)=>{c[e]=n},w=(e,n)=>{let t=[];const r=a[n];if(!c[e])return console.warn(`Component ${e} not found`),"";const o=typeof r;if(r==null)return"";switch(o){case"object":Array.isArray(r)?t=r.map(s=>c[e](s)):t.push(c[e](r));break;case"string":t.push(c[e](r));break;default:throw new Error(`Unsupported data type: ${o}`)}return Array.isArray(t)?t.join(""):t},H=(e,n)=>{let t=[];return e.forEach((r,o)=>{const s=a[n[o]];if(!c[r])return;const i=typeof s;switch(i){case"object":Array.isArray(s)?t=t.concat(s.map(d=>c[r](d))):t.push(c[r](s));break;case"string":t.push(c[r](s));break;default:throw new Error(`Unsupported data type: ${i}`)}}),Array.isArray(t)?t.join(""):t};let f=window.location.pathname,l=[],b=()=>Promise.resolve(),A=()=>{};const O=e=>{b=e},U=e=>{A=e},M=e=>{l=JSON.parse(e).views},V=()=>y("GET","views/views.json","application/json; charset=UTF-8",M),_=(e,n)=>{const t="views/"+l[e].viewFile;return new Promise((r,o)=>{fetch(t+"?").then(s=>{if(s.ok)return s.text();o(`Failed to load HTML view: ${t}`)}).then(s=>{const i=u(n);i?(i.innerHTML=s,r()):o(`Target element with ID "${n}" not found`)}).catch(o)})},T=e=>new Promise((n,t)=>{let r;const o=f||"/";if(!l||l.length===0){t("Views are undefined or empty, cannot load template.");return}for(let s=0;s<l.length;s++)if(l[s].url===o){r=s;break}r===void 0&&(console.warn(`No view found for the URL: ${o}. Redirecting to default view.`),r=0),_(r,e).then(()=>n()).catch(s=>{console.error(`Error filling view for URL ${o}: ${s}`),t(`Failed to fill view for ${o}`)})}).catch(n=>{console.error(`Error in getTemplate: ${n}`)}),J=e=>{history.pushState(null,null,e),f=e,T("contentBody").then(()=>{b()})},K=()=>{window.onpopstate=e=>{f=window.location.pathname,A()}},S=()=>new Promise((e,n)=>{const t=u("contentBody");if(!t){e();return}const r=t.querySelectorAll("[datasource]");[].forEach.call(r,o=>{o.innerHTML=w(o.tagName.toLowerCase(),o.getAttribute("datasource"))}),p("Switched View","CBody","NA"),e()}),z=e=>{const n=u("contentBody");n&&n.querySelectorAll('[datasource="'+e+'"]').forEach(t=>{t.innerHTML=w(t.tagName.toLowerCase(),e),p("Updated Data.",t.tagName.toLowerCase(),"No Comment.")})};O(S),j(z);const v={},G=e=>{Object.defineProperty(v,"trigger",{get:function(){return this._trigger},set:function(n){this._trigger=n,typeof window[n]=="function"&&window[n]()}}),v.trigger=e},I=e=>{if(typeof window[e]=="function")return window[e]()},Y=e=>new Promise((n,t)=>{let r=["components.js"];e?.components&&Array.isArray(e.components)&&e.components.length>0&&(r=e.components),E("components",r).then(()=>{V().then(()=>{T("contentBody").then(()=>{S().then(()=>{K(),typeof e.callbackName<"u"&&I(e.callbackName),n()})})})})}),x=e=>{Y(e)};U(()=>x());const $={wx:u,wijax:y,jsonize:D,loadScript:h,registerComponent:q,buildComponent:w,buildComponents:H,components:c,registerProfile:L,registerAction:p,navigateTo:J,registerData:k,addData:P,findIndexByKey:B,updateData:R,removeData:F,dataStore:a,onLoad:G,init:x};return typeof window<"u"&&(window.wu=$),$})();
